"use strict";var SHUTTHEBOX=window.SHUTTHEBOX={};!function(e){e.state={players:[],currentPlayer:null,currentlySelectedTiles:[],selectableTiles:[],onlyTileOne:!1,turnStarted:!1,winner:null,tiles:{1:!0,2:!0,3:!0,4:!0,5:!0,6:!0,7:!0,8:!0,9:!0},dice:[1,1]}}(SHUTTHEBOX);
"use strict";!function(e){var t=e.utils={};t.keys=Object.keys(e.state.tiles),t.randomNumGenerator=function(){return Math.floor(6*Math.random())+1},t.onlyTileOneOpen=function(){if(!e.state.onlyTileOne){var n=!0;return t.keys.forEach(function(t){"1"!==t&&e.state.tiles[t]===!0&&(n=!1)}),e.state.onlyTileOne=n,n}},t.getDiceTotal=function(){return e.state.dice.reduce(function(e,t){return e+t})},t.shutTiles=function(t){t.forEach(function(t){e.state.tiles[t]=!1})},t.getRemainingChoices=function(n){var r=e.state.currentlySelectedTiles,i=void 0;i=0===r.length?0:r.map(function(e){return parseInt(e)}).reduce(function(e,t){return e+t});var u=n-i;return t.keys.filter(function(t){return e.state.tiles[t]&&parseInt(t)<=u&&-1===r.indexOf(t)})},t.resetTiles=function(){t.keys.forEach(function(t){e.state.tiles[t]=!0})},t.addOpenTiles=function(){var n=0;return t.keys.forEach(function(t){e.state.tiles[t]&&(n+=parseInt(t))}),n},t.returnWinner=function(){var t=0;return e.state.players.forEach(function(n,r){n.score<e.state.players[t].score&&(t=r)}),e.state.players[t]},t.validSelection=function(){if(0!==e.state.currentlySelectedTiles.length){var n=t.getDiceTotal(),r=e.state.currentlySelectedTiles.map(function(e){return parseInt(e)}).reduce(function(e,t){return e+t});return n===r}},t.isSolutionPossible=function(e,t){var n=[[]];t.map(function(e){return parseInt(e)}).forEach(function(e){n.forEach(function(t){n.push(t.concat(e))})});for(var r=1,i=n.length;i>r;r++){var u=n[r].reduce(function(e,t){return e+t});if(u===e)return!0}return!1}}(SHUTTHEBOX);
"use strict";!function(e){var t=e.utils,r=e.methods={};r.setPlayers=function(t){for(var r=0;t>r;r++)e.state.players.push({name:"Player "+(r+1),score:0})},r.pickTile=function(r){if("string"==typeof r){var s=e.state.currentlySelectedTiles,a=s.indexOf(r),n=t.getDiceTotal();-1===a?s.push(r):s.splice(a,1),e.state.selectableTiles=t.getRemainingChoices(n)}},r.startGame=function(){t.resetTiles(),e.state.currentPlayer=e.state.players[0]},r.resetGame=function(){t.resetTiles(),e.state.players=[],e.state.currentlySelectedTiles=[],e.state.currentPlayer=null,e.state.onlyTileOne=!1,e.state.winner=null,e.state.turnStarted=!1},r.roll=function(){if(e.state.turnStarted){if(!t.validSelection()){var r=t.getDiceTotal();return void alert("Your selected tiles must add up to "+r+"!")}}else e.state.turnStarted=!0;t.shutTiles(e.state.currentlySelectedTiles),e.state.currentlySelectedTiles=[];var s=t.randomNumGenerator();if(e.state.onlyTileOne)return e.state.dice=[s],e.state.dice;var a=t.randomNumGenerator();e.state.dice=[s,a];var n=t.getDiceTotal();return e.state.selectableTiles=t.getRemainingChoices(n),t.isSolutionPossible(n,e.state.selectableTiles)?e.state.dice:"No solution possible"},r.endTurn=function(){var r=e.state.currentPlayer,s=e.state.players;return r.score=t.addOpenTiles(),t.resetTiles(),e.state.currentlySelectedTiles=[],s.indexOf(r)===s.length-1?(e.state.winner=t.returnWinner(),e.state.winner):(e.state.currentPlayer=s[s.indexOf(r)+1],e.state.onlyTileOne=!1,e.state.turnStarted=!1,void alert("End of turn for "+r.name+"! Next up "+e.state.currentPlayer.name+"!"))}}(SHUTTHEBOX);
"use strict";!function(e,t){t(function(){function a(a){a&&a.stopPropagation(),e.methods.endTurn(),null!==e.state.winner&&(r(),alert(e.state.winner.name+" is the winner!"),l(),d.removeClass("slide-down")),v.addClass("cannot-select"),v.children().each(function(e,a){var n=t(a);n.removeClass("cannot-select"),n.removeClass("selected")}),m.empty(),o(),r()}function n(){v.children().each(function(a,n){var s=t(n),o=s.attr("data-value");-1!==e.state.selectableTiles.indexOf(o)&&e.state.tiles[o]?s.hasClass("cannot-select")&&s.removeClass("cannot-select"):s.addClass("cannot-select")})}function s(){v.children().each(function(a,n){var s=t(n),o=s.attr("data-value");e.state.tiles[o]||s.addClass("shut")})}function o(){v.children().each(function(e,a){var n=t(a);n.removeClass(),n.addClass("number")})}function r(){C.empty();var a=t("<div></div>");e.state.players.forEach(function(n){var s=t("<h3>"+n.name+" - "+n.score+"</h3>");n===e.state.currentPlayer&&s.addClass("current-player"),a.append(s)}),C.append(a)}function l(){e.methods.resetGame(),o(),m.empty(),u.addClass("hide")}var c=t(document),i=t("#num-players"),d=t(".start-screen"),u=t("#game"),v=t("#tiles"),m=t("#dice-container"),p=t("#roll-dice"),h=t("#end-turn"),f=t("#end-game"),C=t("#score-board");c.on("submit",function(t){t.preventDefault(),t.stopPropagation();var a=parseInt(i.val());return isNaN(a)||1>a||a>4?void alert("Please enter a number between 1 and 4!"):(e.methods.setPlayers(a),e.methods.startGame(),v.addClass("cannot-select"),d.addClass("slide-down"),u.removeClass("hide"),void r())}),v.on("click",function(a){a.stopPropagation();var s=t(a.target),o=s.attr("data-value"),r=s.hasClass("shut"),l=s.hasClass("cannot-select");!r&&e.state.turnStarted&&(l&&-1===e.state.currentlySelectedTiles.indexOf(o)||(e.methods.pickTile(s.attr("data-value")),n(),s.toggleClass("selected")))}),p.on("click",function(o){o.stopPropagation(),v.removeClass("cannot-select");var r=e.methods.roll();s(),m.empty();var l=t("<div></div>");e.state.dice.forEach(function(e){var a=t('<div class="number"></div>');a.text(e),l.append(a)}),m.prepend(l),n(),"No solution possible"===r&&a()}),h.on("click",a),f.on("click",function(e){e.stopPropagation(),l(),d.removeClass("slide-down")})})}(window.SHUTTHEBOX,window.jQuery);