"use strict";var SHUTTHEBOX=window.SHUTTHEBOX={};!function(e){e.state={players:[],currentPlayer:null,currentlySelectedTiles:[],selectableTiles:[],onlyTileOne:!1,turnStarted:!1,winner:null,tiles:{1:!0,2:!0,3:!0,4:!0,5:!0,6:!0,7:!0,8:!0,9:!0},dice:[1,1]}}(SHUTTHEBOX);
"use strict";!function(e){var t=e.utils={};t.keys=Object.keys(e.state.tiles),t.randomNumGenerator=function(){return Math.floor(6*Math.random())+1},t.onlyTileOneOpen=function(){if(!e.state.onlyTileOne){var n=!0;return t.keys.forEach(function(t){"1"!==t&&e.state.tiles[t]===!0&&(n=!1)}),e.state.onlyTileOne=n,n}},t.getDiceTotal=function(){return e.state.dice.reduce(function(e,t){return e+t})},t.shutTiles=function(t){t.forEach(function(t){e.state.tiles[t]=!1})},t.getRemainingChoices=function(n){var r=e.state.currentlySelectedTiles,i=void 0;i=0===r.length?0:r.map(function(e){return parseInt(e)}).reduce(function(e,t){return e+t});var s=n-i;return t.keys.filter(function(t){return e.state.tiles[t]&&parseInt(t)<=s&&-1===r.indexOf(t)})},t.resetTiles=function(){t.keys.forEach(function(t){e.state.tiles[t]=!0})},t.addOpenTiles=function(){var n=0;return t.keys.forEach(function(t){e.state.tiles[t]&&(n+=parseInt(t))}),n},t.returnWinner=function(){var t=0;return e.state.players.forEach(function(n,r){n.score<e.state.players[t].score&&(t=r)}),e.state.players[t]},t.validSelection=function(){if(0!==e.state.currentlySelectedTiles.length){var n=t.getDiceTotal(),r=e.state.currentlySelectedTiles.map(function(e){return parseInt(e)}).reduce(function(e,t){return e+t});return n===r}}}(SHUTTHEBOX);
"use strict";!function(e){var t=e.utils,r=e.methods={};r.setPlayers=function(t){for(var r=0;t>r;r++)e.state.players.push({name:"Player "+(r+1),score:0})},r.pickTile=function(r){if("string"==typeof r){var a=e.state.currentlySelectedTiles,n=a.indexOf(r),s=t.getDiceTotal();-1===n?a.push(r):a.splice(n,1),e.state.selectableTiles=t.getRemainingChoices(s)}},r.startGame=function(){t.resetTiles(),e.state.currentPlayer=e.state.players[0]},r.resetGame=function(){t.resetTiles(),e.state.players=[],e.state.currentlySelected=[],e.state.currentPlayer=null,e.state.onlyTileOne=!1,e.state.winner=null,e.state.turnStarted=!1},r.roll=function(){if(e.state.turnStarted){if(!t.validSelection()){var r=t.getDiceTotal();return void alert("Your selected tiles must add up to "+r+"!")}}else e.state.turnStarted=!0;t.shutTiles(e.state.currentlySelectedTiles),e.state.currentlySelectedTiles=[];var a=t.randomNumGenerator();if(e.state.onlyTileOne)return e.state.dice=[a],e.state.dice;var n=t.randomNumGenerator();return e.state.dice=[a,n],e.state.selectableTiles=t.getRemainingChoices(t.getDiceTotal()),e.state.dice},r.endTurn=function(){var r=e.state.currentPlayer,a=e.state.players;return r.score=t.addOpenTiles(),a.indexOf(r)===a.length-1?(e.state.winner=t.returnWinner(),e.state.winner):(e.state.currentPlayer=a[a.indexOf(r)+1],e.state.currentlySelected=[],e.state.onlyTileOne=!1,e.state.turnStarted=!1,t.resetTiles(),void alert("End of turn for "+r.name+"! Next up "+e.state.currentPlayer.name+"!"))}}(SHUTTHEBOX);
"use strict";!function(e,t){t(function(){function a(){u.children().each(function(a,s){var n=t(s),l=n.attr("data-value");-1!==e.state.selectableTiles.indexOf(l)&&e.state.tiles[l]?n.hasClass("cannot-select")&&n.removeClass("cannot-select"):n.addClass("cannot-select")})}function s(){u.children().each(function(a,s){var n=t(s),l=n.attr("data-value");e.state.tiles[l]||n.addClass("shut")})}function n(){u.children().each(function(e,a){var s=t(a);s.removeClass(),s.addClass("number")})}function l(){f.empty();var a=t("<div></div>");e.state.players.forEach(function(s){var n=t("<h3>"+s.name+" - "+s.score+"</h3>");s===e.state.currentPlayer&&n.addClass("current-player"),a.append(n)}),f.append(a)}function o(){e.methods.resetGame(),n(),v.empty(),i.addClass("hide")}var r=t(document),c=t("#num-players"),d=t(".start-screen"),i=t("#game"),u=t("#tiles"),v=t("#dice-container"),m=t("#roll-dice"),h=t("#end-turn"),p=t("#end-game"),f=t("#score-board");r.on("submit",function(t){t.preventDefault(),t.stopPropagation();var a=parseInt(c.val());return isNaN(a)||1>a||a>4?void alert("Please enter a number between 1 and 4!"):(e.methods.setPlayers(a),e.methods.startGame(),u.addClass("cannot-select"),d.addClass("slide-down"),i.removeClass("hide"),void l())}),u.on("click",function(s){s.stopPropagation();var n=t(s.target),l=n.attr("data-value"),o=n.hasClass("shut"),r=n.hasClass("cannot-select");!o&&e.state.turnStarted&&(r&&-1===e.state.currentlySelectedTiles.indexOf(l)||(e.methods.pickTile(n.attr("data-value")),a(),n.toggleClass("selected")))}),m.on("click",function(n){n.stopPropagation(),u.hasClass("cannot-select")&&u.removeClass("cannot-select"),e.methods.roll(),s(),v.empty();var l=t("<div></div>");e.state.dice.forEach(function(e){var a=t('<div class="number"></div>');a.text(e),l.append(a)}),v.prepend(l),a()}),h.on("click",function(a){a.stopPropagation(),e.methods.endTurn(),null!==e.state.winner&&(l(),alert(e.state.winner.name+" is the winner!"),o(),d.removeClass("slide-down")),u.addClass("cannot-select"),u.children().each(function(e,a){var s=t(a);s.hasClass("cannot-select")&&s.removeClass("cannot-select"),s.hasClass("selected")&&s.removeClass("selected")}),v.empty(),n(),l()}),p.on("click",function(e){e.stopPropagation(),o(),d.removeClass("slide-down")})})}(window.SHUTTHEBOX,window.jQuery);